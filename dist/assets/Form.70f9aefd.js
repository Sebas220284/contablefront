import{d as Ce,E as we,k as b,D as Ae,b9 as We,C as Ee,O as d,aB as Fe,o as f,c as S,p as o,w as s,z as B,ba as $,bE as O,q as l,bi as Ue,b as E,m as a,V as De,F as le,a as ae,x as u,I as F,bj as Ie,bk as Be,y as $e}from"./index.1bb36a93.js";import{u as Oe}from"./useCrudPayrollStore.398992bd.js";import{r as C,l as Le,n as i,v as U}from"./validators.bb8f1929.js";import{u as Pe,V as Re}from"./useImageUpload.49dcf1d8.js";import{a as _,V as p}from"./VRow.971cb494.js";import{V as L}from"./VBtn.22d55266.js";import{V as P}from"./VSelect.ff4ebc03.js";import{V as N}from"./VTextField.1b37a66e.js";import{V as Te,a as ne}from"./VRadioGroup.dd1ceab0.js";import{V as oe}from"./VTable.ef7fd960.js";import{V as se}from"./VCheckbox.b279b9c1.js";import{V as qe}from"./VForm.9a7f2cfe.js";import"./VCounter.f77d3b0b.js";import"./index.5010adc7.js";import"./easing.36b781ab.js";import"./forwardRefs.c003b6b8.js";import"./VChip.588e72fe.js";import"./sweetalert2.74fe64d4.js";/* empty css              */import"./VList.3fcbcdee.js";import"./VDivider.5fbe829f.js";import"./scopeId.cb53369a.js";import"./lazy.6b2881de.js";import"./VMenu.a89a99b8.js";import"./VCheckboxBtn.169cdc89.js";const r=w=>(Ie("data-v-4f192857"),w=w(),Be(),w),ze=["href"],Ge=r(()=>a("b",null,"Descargar formato",-1)),He={key:0,class:"row"},Je={class:"col-12"},Qe=r(()=>a("thead",null,[a("tr",null,[a("th",null,"Fila"),a("th",null,"Columna"),a("th",null,"Error"),a("th",null,"Valor")])],-1)),Ke=r(()=>a("tr",null,[a("th",{class:"text-center border",colspan:"4"}," EMPLEADO "),a("th",{class:"text-center border",colspan:"7"}," DEVENGADO "),a("th",{class:"text-center border",colspan:"5"}," DEDUCCIONES "),a("th",{class:"text-center border",colspan:"5"}," PRESTACIONES SOCIALES EMPLEADOR "),a("th",{class:"text-center border",colspan:"4"}," TOTAL PLANILLA "),a("th",{class:"text-center border",colspan:"5"}," PROVISIONES ")],-1)),Xe={scope:"col",class:"text-center"},Ye={style:{width:"1rem"}},Ze=r(()=>a("th",{class:"tableMinWidth"}," Nombre ",-1)),je=r(()=>a("th",{class:"tableMinWidth"}," N identificaci\xF3n ",-1)),et=r(()=>a("th",{class:"tableMinWidth"}," Sueldo ",-1)),tt=r(()=>a("th",{class:"tableMinWidth"}," Dias trabajados ",-1)),lt=r(()=>a("th",{class:"tableMinWidth"}," Salario ",-1)),at=r(()=>a("th",{class:"tableMinWidth"}," Auxilio de transporte ",-1)),nt=r(()=>a("th",{class:"tableMinWidth"}," Horas extras ",-1)),ot=r(()=>a("th",{class:"tableMinWidth"}," Bonificaciones ",-1)),st=r(()=>a("th",{class:"tableMinWidth"}," Comisiones ",-1)),rt=r(()=>a("th",{class:"tableMinWidth"}," Total devengado ",-1)),ut=r(()=>a("th",{class:"tableMinWidth"}," Salud ",-1)),it=r(()=>a("th",{class:"tableMinWidth"}," Pensi\xF3n ",-1)),dt=r(()=>a("th",{class:"tableMinWidth"}," Otros descuentos ",-1)),ct=r(()=>a("th",{class:"tableMinWidth"}," Total deducibles ",-1)),_t=r(()=>a("th",{class:"tableMinWidth"}," Total pagado ",-1)),mt=r(()=>a("th",{class:"tableMinWidth"}," Pensi\xF3n ",-1)),pt=r(()=>a("th",{class:"tableMinWidth"}," Caja compensaci\xF3n ",-1)),ht=r(()=>a("th",{class:"tableMinWidth"}," ARL ",-1)),ft=r(()=>a("th",{class:"tableMinWidth"}," Pensi\xF3n ",-1)),vt=r(()=>a("th",{class:"tableMinWidth"}," Salud ",-1)),Vt=r(()=>a("th",{class:"tableMinWidth"}," ARL ",-1)),bt=r(()=>a("th",{class:"tableMinWidth"}," Caja compensaci\xF3n ",-1)),yt=r(()=>a("th",{class:"tableMinWidth"}," Cesantias ",-1)),xt=r(()=>a("th",{class:"tableMinWidth"}," Intereses Cesantias ",-1)),gt=r(()=>a("th",{class:"tableMinWidth"}," Prima salarial ",-1)),Mt=r(()=>a("th",{class:"tableMinWidth"}," Vacaciones ",-1)),kt=r(()=>a("th",{class:"tableMinWidth"}," Total provisiones ",-1)),St={style:{width:"1rem"}},Nt=Ce({__name:"Form",setup(w){const R=we(),re=b(Ae()),x=Oe(),{formulario:h,employees:g,transport_assistance:T,health_percentage:ue,pension_percentage:ie,employeer_pension_percentage:de,employer_compensation_box_percentage:ce,layoffs_percentage:_e,severance_interest_percentage:me,vacation_percentage:pe,fileExcel:he,errorsImport:q,years:fe}=We(x),A=b(Pe());A.value.allowedExtensions=["xls","xlsx"];const z=b(),y=b([]),ve=b(["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiember","Octubre","Noviembre","Diciembre"]),V=b(!1),m=b([]),M=b(!1),Ve=()=>{M.value=!M.value,M.value?g.value.forEach(e=>{m.value.includes(`check${e.id}`)||m.value.push(`check${e.id}`)}):m.value=[]},be=e=>{if(m.value.includes(e)){const t=m.value.indexOf(e);m.value.splice(t,1)}else m.value.push(e),M.value=!0};Ee(m,()=>{m.value.length||(M.value=!1)},{deep:!0});const ye=e=>{e=="Mensual"?g.value.forEach(t=>{t.workedDays=30}):g.value.forEach(t=>{t.workedDays=15})},G=e=>{x.typeAction=e,e!="back"&&x.keyList++},H=async()=>{var t;V.value&&(he.value=A.value.imageFile);const e=await((t=z.value)==null?void 0:t.validate());if(e!=null&&e.valid){h.value.company_id=R.company.id;let n={};V.value?n=await x.importExcel():n=await x.fetchSave(m.value),n.status===200&&G("list"),n.status===422&&(y.value=n.error)}},v=d(()=>function(e){var n,k;const t=Number((n=e.salary)!=null?n:0)/30*Number((k=e.workedDays)!=null?k:0);return e.wage=t,t}),J=d(()=>function(e){var n;const t=Number(T.value)/30*Number((n=e.workedDays)!=null?n:0);return e.amount_transport_assistance=t,t}),Q=d(()=>function(e){const t=v.value(e)+Number(T.value)+Number(e.extra_hours.toString().replaceAll(".","").replace(",","."))+Number(e.bonuses.toString().replaceAll(".","").replace(",","."))+Number(e.commissions.toString().replaceAll(".","").replace(",","."));return e.total_accrued=t,t}),D=d(()=>function(e){const t=(v.value(e)+Number(e.extra_hours.toString().replaceAll(".","").replace(",","."))+Number(e.commissions.toString().replaceAll(".","").replace(",",".")))*(Number(ue.value)/100);return e.deduction_health=t,t}),I=d(()=>function(e){const t=(v.value(e)+Number(e.extra_hours.toString().replaceAll(".","").replace(",","."))+Number(e.commissions.toString().replaceAll(".","").replace(",",".")))*(Number(ie.value)/100);return e.deduction_pension=t,t}),K=d(()=>function(e){const t=D.value(e)+I.value(e)+Number(e.other_discounts.toString().replaceAll(".","").replace(",","."));return e.total_deductibles=t,t}),xe=d(()=>function(e){const t=Q.value(e)-K.value(e);return e.total_paid=t,t}),X=d(()=>function(e){const t=v.value(e)*(de.value/100);return e.employer_pension=t,t}),Y=d(()=>function(e){const t=v.value(e)*(ce.value/100);return e.employer_compensation_box=t,t}),Z=d(()=>function(e){const t=v.value(e)*(Number(e.risk_class_value)/100);return e.employer_arl=t,t}),ge=d(()=>function(e){const t=I.value(e)+X.value(e);return e.total_form_pension=t,t}),Me=d(()=>function(e){const t=D.value(e);return e.total_form_health=t,t}),ke=d(()=>function(e){const t=Z.value(e);return e.total_form_arl=t,t}),Se=d(()=>function(e){const t=Y.value(e);return e.total_form_compensation_box=t,t}),W=d(()=>function(e){const t=(v.value(e)+J.value(e)+Number(e.extra_hours.toString().replaceAll(".","").replace(",","."))+Number(e.commissions.toString().replaceAll(".","").replace(",",".")))*(_e.value/100);return e.layoffs=t,t}),j=d(()=>function(e){const t=W.value(e)*(me.value/100);return e.severance_interest=t,t}),ee=d(()=>function(e){const t=W.value(e);return e.wage_premium=t,t}),te=d(()=>function(e){const t=v.value(e)*(pe.value/100);return e.vacation=t,t}),Ne=d(()=>function(e){const t=W.value(e)+j.value(e)+ee.value(e)+te.value(e);return e.total_provisions=t,t});return Fe(async()=>{await x.fetchDataForm(R.company.id)}),(e,t)=>(f(),S("div",null,[o(p,null,{default:s(()=>[o(_,{cols:"12",class:"d-flex justify-content-end"},{default:s(()=>[o(L,{color:"secondary",onClick:t[0]||(t[0]=n=>G("back"))},{default:s(()=>[B(" Atras ")]),_:1})]),_:1})]),_:1}),o(qe,{ref_key:"formValidation",ref:z,"lazy-validation":""},{default:s(()=>[o(p,null,{default:s(()=>[o(_,{cols:"12"},{default:s(()=>[o($,{title:"Informaci\xF3n general"},{default:s(()=>[o(O,null,{default:s(()=>[o(p,null,{default:s(()=>[o(_,{cols:"3"},{default:s(()=>[o(P,{items:["Mensual","Primera Quincena","Segunda Quincena"],"item-title":"name","item-value":"id","onUpdate:modelValue":[t[1]||(t[1]=n=>{l(y).settlement_type="",ye(n)}),t[2]||(t[2]=n=>l(h).settlement_type=n)],modelValue:l(h).settlement_type,"error-messages":l(y).settlement_type,rules:[l(C)],label:"Tipo de Liquidaci\xF3n"},null,8,["modelValue","error-messages","rules"])]),_:1}),o(_,{cols:"3"},{default:s(()=>[o(N,{label:"Nombre",modelValue:l(h).name,"onUpdate:modelValue":t[3]||(t[3]=n=>l(h).name=n),maxlength:"50",rules:[l(C),l(Le)(l(h).name,50)]},null,8,["modelValue","rules"])]),_:1}),o(_,{cols:"3"},{default:s(()=>[o(P,{items:l(ve),"item-title":"name","item-value":"id","onUpdate:modelValue":[t[4]||(t[4]=n=>l(y).month=""),t[5]||(t[5]=n=>l(h).month=n)],modelValue:l(h).month,"error-messages":l(y).month,rules:[l(C)],label:"Mes"},null,8,["items","modelValue","error-messages","rules"])]),_:1}),o(_,{cols:"3"},{default:s(()=>[o(P,{items:l(fe),"item-title":"name","item-value":"id","onUpdate:modelValue":[t[6]||(t[6]=n=>l(y).year=""),t[7]||(t[7]=n=>l(h).year=n)],modelValue:l(h).year,"error-messages":l(y).year,rules:[l(C)],label:"A\xF1o"},null,8,["items","modelValue","error-messages","rules"])]),_:1})]),_:1}),o(p,null,{default:s(()=>[o(_,{cols:"12"},{default:s(()=>[o(Te,{inline:"",modelValue:l(V),"onUpdate:modelValue":t[8]||(t[8]=n=>Ue(V)?V.value=n:null)},{default:s(()=>[o(ne,{label:"Manual",value:!1}),o(ne,{label:"Masivo",value:!0})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(V)?(f(),E(p,{key:0},{default:s(()=>[o(_,{cols:"12"},{default:s(()=>[o($,null,{default:s(()=>[o(O,null,{default:s(()=>[o(p,null,{default:s(()=>[o(_,{cols:"12"},{default:s(()=>[a("a",{href:l(re).baseURL+"documents/employeePayrollFormat.xlsx",download:""},[Ge,o(De,{icon:"mdi-table-arrow-down"})],8,ze)]),_:1})]),_:1}),o(p,null,{default:s(()=>[o(_,{cols:"12"},{default:s(()=>[(f(),E(Re,{onChange:l(A).handleImageSelected,rules:[l(C)],key:l(A).key},null,8,["onChange","rules"]))]),_:1})]),_:1}),o(p,null,{default:s(()=>[o(_,{cols:"12"},{default:s(()=>[l(q).length>0?(f(),S("div",He,[a("div",Je,[o(oe,{"fixed-header":""},{default:s(()=>[Qe,a("tbody",null,[(f(!0),S(le,null,ae(l(q),(n,k)=>(f(),S("tr",{key:k},[a("td",null,u(n.row),1),a("td",null,u(n.attribute),1),a("td",null,u(n.errors),1),a("td",null,u(n.values),1)]))),128))])]),_:1})])])):F("",!0)]),_:1})]),_:1}),o(p,null,{default:s(()=>[o(_,{cols:"12 d-flex justify-content-center"},{default:s(()=>[o(L,{color:"primary",onClick:t[9]||(t[9]=n=>H()),"prepend-icon":"mdi-upload"},{default:s(()=>[B("Subir")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):F("",!0),l(V)?F("",!0):(f(),E(p,{key:1},{default:s(()=>[o(_,{cols:"12"},{default:s(()=>[o($,{title:"Empleados disponibles para n\xF3mina ("+l(g).length+")"},{default:s(()=>[o(O,null,{default:s(()=>[o(oe,{"fixed-header":""},{default:s(()=>[a("thead",null,[Ke,a("tr",null,[a("th",Xe,[a("div",Ye,[o(se,{"model-value":l(M),indeterminate:l(g).length!==l(m).length&&!!l(m).length,onClick:Ve},null,8,["model-value","indeterminate"])])]),Ze,je,et,tt,lt,at,nt,ot,st,rt,ut,it,dt,ct,_t,mt,pt,ht,ft,vt,Vt,bt,yt,xt,gt,Mt,kt])]),a("tbody",null,[(f(!0),S(le,null,ae(l(g),(n,k)=>(f(),S("tr",{key:k},[a("td",null,[a("div",St,[o(se,{id:`check${n.id}`,"model-value":l(m).includes(`check${n.id}`),onClick:c=>be(`check${n.id}`)},null,8,["id","model-value","onClick"])])]),a("td",null,u(n.full_name),1),a("td",null,u(n.document_number),1),a("td",null,u(l(i)(n.salary)),1),a("td",null,[o(N,{modelValue:n.workedDays,"onUpdate:modelValue":c=>n.workedDays=c,label:"Dias trabajados"},null,8,["modelValue","onUpdate:modelValue"])]),a("td",null,u(l(i)(l(v)(n))),1),a("td",null,u(l(i)(l(J)(n))),1),a("td",null,[o(N,{modelValue:n.extra_hours,"onUpdate:modelValue":c=>n.extra_hours=c,onBlur:c=>n.extra_hours=l(U)(n.extra_hours),label:"Horas extras"},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),a("td",null,[o(N,{modelValue:n.bonuses,"onUpdate:modelValue":c=>n.bonuses=c,onBlur:c=>n.bonuses=l(U)(n.bonuses),label:"Bonificaciones"},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),a("td",null,[o(N,{modelValue:n.commissions,"onUpdate:modelValue":c=>n.commissions=c,onBlur:c=>n.commissions=l(U)(n.commissions),label:"Comisiones"},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),a("td",null,u(l(i)(l(Q)(n))),1),a("td",null,u(l(i)(l(D)(n))),1),a("td",null,u(l(i)(l(I)(n))),1),a("td",null,[o(N,{modelValue:n.other_discounts,"onUpdate:modelValue":c=>n.other_discounts=c,label:"Otros descuentos",onBlur:c=>n.other_discounts=l(U)(n.other_discounts)},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),a("td",null,u(l(i)(l(K)(n))),1),a("td",null,u(l(i)(l(xe)(n))),1),a("td",null,u(l(i)(l(X)(n))),1),a("td",null,u(l(i)(l(Y)(n))),1),a("td",null,u(l(i)(l(Z)(n))),1),a("td",null,u(l(i)(l(ge)(n))),1),a("td",null,u(l(i)(l(Me)(n))),1),a("td",null,u(l(i)(l(ke)(n))),1),a("td",null,u(l(i)(l(Se)(n))),1),a("td",null,u(l(i)(l(W)(n))),1),a("td",null,u(l(i)(l(j)(n))),1),a("td",null,u(l(i)(l(ee)(n))),1),a("td",null,u(l(i)(l(te)(n))),1),a("td",null,u(l(i)(l(Ne)(n))),1)]))),128))])]),_:1})]),_:1})]),_:1},8,["title"])]),_:1})]),_:1})),l(V)?F("",!0):(f(),E(p,{key:2},{default:s(()=>[o(_,{cols:"12 d-flex justify-content-center"},{default:s(()=>[o(L,{color:"primary",onClick:t[10]||(t[10]=n=>H())},{default:s(()=>[B("Guardar")]),_:1})]),_:1})]),_:1}))]),_:1},512)]))}});const Zt=$e(Nt,[["__scopeId","data-v-4f192857"]]);export{Zt as default};

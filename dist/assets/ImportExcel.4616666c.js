import{d as C,E,k as m,b9 as F,o as s,b as h,w as a,p as r,q as n,c as f,m as e,F as S,a as I,x as c,I as B,z as N}from"./index.1bb36a93.js";import{u as T}from"./useCrudPayrollStore.398992bd.js";import{r as q}from"./validators.bb8f1929.js";import{u as z,V as L}from"./useImageUpload.49dcf1d8.js";import{V as p,a as _}from"./VRow.971cb494.js";import{V as R}from"./VTable.ef7fd960.js";import{V as j}from"./VBtn.22d55266.js";import{V as A}from"./VForm.9a7f2cfe.js";import"./VCounter.f77d3b0b.js";import"./index.5010adc7.js";import"./easing.36b781ab.js";import"./forwardRefs.c003b6b8.js";import"./VChip.588e72fe.js";import"./sweetalert2.74fe64d4.js";/* empty css              */const D={key:0,class:"row"},P={class:"col-12"},U=e("thead",null,[e("tr",null,[e("th",null,"Fila"),e("th",null,"Columna"),e("th",null,"Error"),e("th",null,"Valor")])],-1),re=C({__name:"ImportExcel",setup($){const y=E(),i=m(z());i.value.allowedExtensions=["xls","xlsx"];const u=T(),{fileExcel:v,errorsImport:V,formulario:x}=F(u),k=m([]),d=m(),b=async l=>{var o;await((o=d.value)==null?void 0:o.resetValidation()),u.typeAction=l,l!="back"&&u.keyList++},g=async()=>{var o;v.value=i.value.imageFile;const l=await((o=d.value)==null?void 0:o.validate());if(l!=null&&l.valid){x.value.company_id=y.company.id;const t=await u.importExcel();t.status===200&&b("save"),t.status===422&&(k.value=t.error)}};return(l,o)=>(s(),h(A,{ref_key:"formValidation",ref:d,"lazy-validation":""},{default:a(()=>[r(p,null,{default:a(()=>[r(_,{cols:"12"},{default:a(()=>[(s(),h(L,{onChange:n(i).handleImageSelected,rules:[n(q)],key:n(i).key},null,8,["onChange","rules"]))]),_:1})]),_:1}),r(p,null,{default:a(()=>[r(_,{cols:"12"},{default:a(()=>[n(V).length>0?(s(),f("div",D,[e("div",P,[r(R,{"fixed-header":""},{default:a(()=>[U,e("tbody",null,[(s(!0),f(S,null,I(n(V),(t,w)=>(s(),f("tr",{key:w},[e("td",null,c(t.row),1),e("td",null,c(t.attribute),1),e("td",null,c(t.errors[0]),1),e("td",null,c(t.values[t.attribute]),1)]))),128))])]),_:1})])])):B("",!0)]),_:1})]),_:1}),r(p,null,{default:a(()=>[r(_,{cols:"12 d-flex justify-content-center"},{default:a(()=>[r(j,{color:"primary",onClick:o[0]||(o[0]=t=>g()),"prepend-icon":"mdi-upload"},{default:a(()=>[N("Subir")]),_:1})]),_:1})]),_:1})]),_:1},512))}});export{re as default};

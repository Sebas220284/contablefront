import{m as Z,a as q,f as J,b as K,V as Q,c as W,d as X}from"./VCounter.f77d3b0b.js";import{f as Y}from"./forwardRefs.c003b6b8.js";import{Z as ee,aD as le,av as te,M as ne,O as p,bG as x,k as c,R as ae,bs as oe,p as o,U as I,F as b,bu as $,aG as ie,C as se}from"./index.1bb36a93.js";import{V as ue}from"./VChip.588e72fe.js";import{S as A}from"./sweetalert2.74fe64d4.js";const pe=ee({name:"VFileInput",inheritAttrs:!1,props:{chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},multiple:Boolean,hint:String,persistentHint:Boolean,placeholder:String,showSize:{type:[Boolean,Number],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(e)},...Z({prependIcon:"$file"}),modelValue:{type:Array,default:()=>[],validator:e=>le(e).every(s=>s!=null&&typeof s=="object")},...q({clearable:!0})},emits:{"click:control":e=>!0,"update:modelValue":e=>!0},setup(e,s){let{attrs:y,emit:v,slots:n}=s;const{t:d}=te(),t=ne(e,"modelValue"),u=p(()=>typeof e.showSize!="boolean"?e.showSize:void 0),g=p(()=>{var l;return((l=t.value)!=null?l:[]).reduce((a,i)=>{let{size:C=0}=i;return a+C},0)}),F=p(()=>x(g.value,u.value)),S=p(()=>{var l;return((l=t.value)!=null?l:[]).map(a=>{const{name:i="",size:C=0}=a;return e.showSize?`${i} (${x(C,u.value)})`:i})}),D=p(()=>{var i;var l;const a=(i=(l=t.value)==null?void 0:l.length)!=null?i:0;return e.showSize?d(e.counterSizeString,a,F.value):d(e.counterString,a)}),w=c(),z=c(),m=c(!1),r=c(),E=p(()=>e.messages.length?e.messages:e.persistentHint?e.hint:"");function V(){if(r.value!==document.activeElement){var l;(l=r.value)==null||l.focus()}m.value||(m.value=!0)}function U(l){$(e["onClick:prepend"],l),R(l)}function R(l){var a;(a=r.value)==null||a.click(),v("click:control",l)}function L(l){l.stopPropagation(),V(),ie(()=>{t.value=[],r!=null&&r.value&&(r.value.value=""),$(e["onClick:clear"],l)})}return ae(()=>{const l=!!(n.counter||e.counter),a=!!(l||n.details),[i,C]=oe(y),[{modelValue:re,...N}]=J(e),[j]=K(e);return o(X,I({ref:w,modelValue:t.value,"onUpdate:modelValue":h=>t.value=h,class:"v-file-input","onClick:prepend":U,"onClick:append":e["onClick:append"]},i,N,{focused:m.value,messages:E.value}),{...n,default:h=>{let{isDisabled:k,isDirty:B,isReadonly:M,isValid:O}=h;return o(Q,I({ref:z,"prepend-icon":e.prependIcon,"onClick:control":R,"onClick:clear":L,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},j,{active:B.value||m.value,dirty:B.value,focused:m.value,error:O.value===!1}),{...n,default:_=>{let{props:{class:G,...H}}=_;return o(b,null,[o("input",I({ref:r,type:"file",readonly:M.value,disabled:k.value,multiple:e.multiple,name:e.name,onClick:f=>{f.stopPropagation(),V()},onChange:f=>{var P;if(!f.target)return;const T=f.target;t.value=[...(P=T.files)!=null?P:[]]},onFocus:V,onBlur:()=>m.value=!1},H,C),null),o("div",{class:G},[t.value.length>0&&(n.selection?n.selection({fileNames:S.value,totalBytes:g.value,totalBytesReadable:F.value}):e.chips?S.value.map(f=>o(ue,{key:f,size:"small",color:e.color},{default:()=>[f]})):S.value.join(", "))])])}})},details:a?h=>{var k;return o(b,null,[(k=n.details)==null?void 0:k.call(n,h),l&&o(b,null,[o("span",null,null),o(W,{active:!!t.value.length,value:D.value},n.counter)])])}:void 0})}),Y({},w,z,r)}});function ge(){const e=c(null),s=c(null),y=c(1),v=c([]);function n(){var g;var t=parseInt(event.target.files[0].size/1024);if(t>3e3)return A.fire({icon:"error",title:"Oops...",text:"Debe registrar m\xE1ximo 3MB",customClass:{container:"my-swal"}}),d(),!1;const u=(g=event.target.files[0].name.split(".").pop())==null?void 0:g.toLowerCase();return v.value.length>0&&!v.value.includes(u)?(A.fire({icon:"error",title:"Oops...",text:`Solo se admite archivos con extensi\xF3nes: ${v.value.join(", ")}`,customClass:{container:"my-swal"}}),d(),!1):event.target.files.length===0?(d(),!1):(e.value=event.target.files[0],!0)}se(e,t=>{if(!(t instanceof File))return;const u=new FileReader;u.readAsDataURL(t),u.addEventListener("load",()=>{s.value=u.result})});function d(){e.value=null,s.value=null,y.value++}return{imageFile:e,imageUrl:s,handleImageSelected:n,key:y,allowedExtensions:v,clearData:d}}export{pe as V,ge as u};

import{bo as c,k as r,bg as n,bp as i,bq as u}from"./index.1bb36a93.js";import{S as g}from"./sweetalert2.74fe64d4.js";const s=u(),h=c("useCrudProductStore",{state:()=>({typeAction:"list",keyList:0,loading:!0,show:!1,products:[],showModalStoreProduct:!1,formulario:r({typeProduct_id:1,company_id:null,code:null,ivaIncluded:null,name:null,price:null,taxCharge_id:null,unitOfMeasurement_id:null,unitOfMeasurement:null,factoryReference:null,barcode:null,description:null,taxClassification_id:null,withholdingTaxes_id:null,valueInpoconsumo:null,applyConsumptionTax:null,model:null,tariffCode:null,mark:null}),currentPage:r(1),totalCompanies:r(0),totalPage:r(0),lastPage:0,totalData:r(0),typeProducts:[],taxCharges:[],taxClassifications:[],withholdingTaxes:[],arrayImages:[],pathExcel:"",searchProduct:{},fileExcel:null,errorsImport:[],formImport:{}}),getters:{},actions:{clearFormulario(){this.formulario={typeProduct_id:1,company_id:null,code:null,ivaIncluded:null,name:null,price:null,taxCharge_id:null,unitOfMeasurement_id:null,unitOfMeasurement:null,factoryReference:null,barcode:null,description:null,taxClassification_id:null,withholdingTaxes_id:null,valueInpoconsumo:null,applyConsumptionTax:null,model:null,tariffCode:null,mark:null}},async fetchAll(o){this.loading=!0,await n.post("/product-list",o).then(e=>{this.loading=!1,this.products=e.data.products,this.totalPage=e.data.totalPage,this.currentPage=e.data.currentPage,this.lastPage=e.data.lastPage,this.totalData=e.data.totalData}).catch(async e=>{this.loading=!1,console.log(await e)})},async fetchDataForm(o){const e=i();e.isLoading=!0,await n.post("/product-dataForm",{company_id:o}).then(a=>{e.isLoading=!1,this.typeProducts=a.data.typeProducts,this.taxCharges=a.data.taxCharges,this.withholdingTaxes=a.data.withholdingTaxes,this.taxClassifications=a.data.taxClassifications}).catch(async a=>{e.isLoading=!1,console.log(await a)})},async fetchSave(){const o=new FormData;for(const t in this.formulario)o.append(t,this.formulario[t]);o.append("cantImageProducts",String(this.arrayImages.length)),this.arrayImages.forEach((t,d)=>{o.append("imageProduct"+d,t.imageFile),o.append("imageProduct_id"+d,String(t.id)),o.append("imageProduct_delete"+d,String(t.delete))});const e=i();return e.isLoading=!0,await await n.post("/product-create",o).then(t=>(e.isLoading=!1,t.data.code===200&&s.toast("\xC9xito",t.data.message,"success"),t.data.code===500&&s.toast("Error",t.data.message,"danger"),t.data.status===422?(s.toast("Error",t.data.message,"danger"),{error:t.data.errors,status:t.data.status}):{status:t.data.code})).catch(async t=>(e.isLoading=!1,console.log(await t),t.response.state===500&&s.toast("Error",t.response.data.message,"danger"),{status:t.response.state}))},async fetchDelete(o){const e=i();return e.isLoading=!0,await await n.delete(`/product-delete/${o}`).then(t=>(e.isLoading=!1,t.data.code===200&&s.toast("\xC9xito",t.data.message,"success"),t.data.code===500&&s.toast("Error",t.data.message,"danger"),t.data.code)).catch(async t=>(e.isLoading=!1,console.log(await t),t.response.state===500&&s.toast("Error",t.response.data.message,"danger"),t.response.state))},async fetchInfoProduct(o){const e=i();e.isLoading=!0,await n.get(`/product-info/${o}`).then(async a=>{e.isLoading=!1,this.formulario=await a.data.data,this.arrayImages=await a.data.arrayImages}).catch(async a=>{e.isLoading=!1,console.log(await a)})},async excel(o){const e=i();e.isLoading=!0,await n.post("/product-excel",o).then(a=>{e.isLoading=!1,this.pathExcel=a.data.path}).catch(async a=>{e.isLoading=!1,console.log(await a)})},changeState(o,e){const a=i();let t="";e==0?t="activar":t="inactivar",g.fire({title:"\xBFEst\xE1 seguro de "+t+" el Registro seleccionado?",showDenyButton:!0,confirmButtonText:"Si",denyButtonText:"No",allowOutsideClick:!1}).then(d=>{d.isConfirmed?(a.isLoading=!0,n.post("/product-changeState",o).then(l=>{a.isLoading=!1,l.data.code==200&&s.toast("\xC9xito",l.data.msg,"success"),l.data.code==500&&s.toast("\xC9xito",l.data.msg,"danger")})):t=="activar"?o.state=0:o.state=1})},async importExcel(){if(this.fileExcel!==null){const o=i(),e=new FormData;for(const a in this.formulario)e.append(a,this.formulario[a]);return e.append("fileExcel",this.fileExcel),await n.post("/product-importExcel",e).then(a=>(o.isLoading=!1,console.log("result",a.data),a.data.code===200&&s.toast("\xC9xito",a.data.message,"success"),a.data.code===500&&s.toast("Error",a.data.message,"danger"),a.data.code===422?(s.toast("Error",a.data.message,"danger"),this.errorsImport=a.data.errorsImport,console.log("this.errorsImport",this.errorsImport),{status:a.data.code}):{status:a.data.code,formedit:a.data.data})).catch(async a=>(o.isLoading=!1,console.log("datadata",a.response),a.response.status))}return{}}}});export{h as u};

import{bo as n,bg as s,bp as r,bq as c}from"./index.1bb36a93.js";const o=c(),l=n("useCrudInvoiceStore",{state:()=>({loading:!1,showInvoice:!1,typeAction:"list",invoiceData:{},keyList:0,invoices:[],currencys:[],taxCharge:[],withholdingTaxe:[],arrayIva:[],arrayWithholdingTaxe:[],products:[],errorsArrayProduct:[],errorsArrayWayToPay:[],totalData:0,totalPage:0,currentPage:1,lastPage:0,pathExcel:"",campDisabledAutomaticNumbering:!0,searchInvoice:{},formulario:{id:null,typesReceiptInvoice_id:null,customer_id:null,seller_id:null,currency_id:null,date_elaboration:"",observation:"",number:0,attachFile:null},arrayWayToPay:[],arrayProducts:[],customers_arrayInfo:[],customers_countLinks:0,userSeller_arrayInfo:[],userSeller_countLinks:0,typesReceiptInvoices_arrayInfo:[],typesReceiptInvoices_countLinks:0,products_arrayInfo:[],products_countLinks:0,arrayInfo:[],countLinks:0}),getters:{},actions:{clearFormulario(){this.formulario={id:null,typesReceiptInvoice_id:null,customer_id:null,seller_id:null,currency_id:null,date_elaboration:"",observation:"",number:0,attachFile:null},this.arrayWayToPay=[],this.arrayProducts=[],this.arrayIva=[],this.arrayWithholdingTaxe=[]},clonarForm(){for(const e in this.formulario)this.invoiceData[e]=this.formulario[e]},async fetchAll(e){this.loading=!0,await s.post("/invoiceSale-list",e).then(t=>{this.loading=!1,this.invoices=t.data.invoices,this.totalData=t.data.totalData,this.totalPage=t.data.totalPage,this.currentPage=t.data.currentPage,this.lastPage=t.data.lastPage}).catch(async t=>{this.loading=!1,console.log(await t)})},async fetchDataForm(e){const t=r();t.isLoading=!0,await s.post("/invoiceSale-dataForm",{company_id:e}).then(a=>{t.isLoading=!1,this.currencys=a.data.currencys,this.customers_arrayInfo=a.data.customers_arrayInfo,this.customers_countLinks=a.data.customers_countLinks,this.userSeller_arrayInfo=a.data.userSeller_arrayInfo,this.userSeller_countLinks=a.data.userSeller_countLinks,this.typesReceiptInvoices_arrayInfo=a.data.typesReceiptInvoices_arrayInfo,this.typesReceiptInvoices_countLinks=a.data.typesReceiptInvoices_countLinks,this.products_arrayInfo=a.data.products_arrayInfo,this.products_countLinks=a.data.products_countLinks,this.arrayInfo=a.data.arrayInfo,this.countLinks=a.data.countLinks,this.taxCharge=a.data.taxCharge,this.withholdingTaxe=a.data.withholdingTaxe}).catch(async a=>{t.isLoading=!1,console.log(await a)})},async fetchSave(){const e=new FormData;for(const i in this.formulario)e.append(i,this.formulario[i]);this.formulario.arrayProducts=this.arrayProducts,this.formulario.arrayWayToPay=this.arrayWayToPay,this.formulario.arrayIva=this.arrayIva,this.formulario.arrayWithholdingTaxe=this.arrayWithholdingTaxe,e.append("arrayProducts",JSON.stringify(this.formulario.arrayProducts)),e.append("arrayWayToPay",JSON.stringify(this.formulario.arrayWayToPay)),e.append("arrayIva",JSON.stringify(this.formulario.arrayIva)),e.append("arrayWithholdingTaxe",JSON.stringify(this.formulario.arrayWithholdingTaxe));const t=r();return t.isLoading=!0,await await s.post("/invoiceSale-create",e).then(i=>(t.isLoading=!1,i.data.code===200&&(this.formulario=i.data.data,this.clonarForm(),o.toast("\xC9xito",i.data.message,"success")),i.data.code===500&&o.toast("Error",i.data.message,"danger"),i.data.code===205&&o.toast("Error",i.data.message,"danger"),i.data.status===422?(o.toast("Error",i.data.message,"danger"),{error:i.data.errors,status:i.data.status}):{status:i.data.code})).catch(async i=>(t.isLoading=!1,i.response.status===500&&o.toast("Error",i.response.data.message,"danger"),console.log(await i),{status:i.response.status}))},async addWayToPay(){this.errorsArrayWayToPay.push({ledgerAccount_id:"",amount:""}),this.arrayWayToPay.push({id:null,ledgerAccount_id:null,amount:null,delete:null})},deleteWayToPay(e,t){if(t.id){let a=this.arrayWayToPay.find(i=>i.id===t.id);a.delete="delete",a.amount="0"}else this.arrayWayToPay.splice(e,1)},async addArrayProducts(){this.errorsArrayProduct.push({product_id:"",quantity:"",unit_value:"",discount_rate:"",tax_charge:"",withholding_tax:"",invoice_id:"",value_total:""}),this.arrayProducts.push({id:null,delete:null})},deleteArrayProducts(e,t){if(t.id){let a=this.arrayProducts.find(i=>i.id===t.id);a.delete="delete",a.quantity="0",a.unit_value="0",a.discount_rate="0"}else this.arrayProducts.splice(e,1)},async fetchProductList(e){return this.loading=!0,await s.post("/product-select2",e).then(a=>(this.loading=!1,this.products_arrayInfo=a.data.products_arrayInfo)).catch(async a=>{this.loading=!1,console.log(await a)})},async fetchDelete(e){const t=r();t.isLoading=!0,await s.delete("/invoiceSale-delete/"+e).then(a=>{t.isLoading=!1,o.toast("\xC9xito",a.data.message,"success")}).catch(async a=>{t.isLoading=!1,console.log(await a)})},async fetchInfoInvoice(e){const t=r();t.isLoading=!0,await s.get(`/invoiceSale-info/${e}`).then(async a=>{t.isLoading=!1,this.formulario=await a.data.data,this.arrayWayToPay=a.data.data.invoice_payment_method,this.arrayProducts=a.data.data.invoice_products,this.clonarForm(),this.errorsArrayProduct=[],this.errorsArrayWayToPay=[],this.arrayProducts.forEach(i=>{this.errorsArrayProduct.push({product_id:"",quantity:"",unit_value:"",discount_rate:"",tax_charge:"",withholding_tax:"",invoice_id:"",value_total:""})}),this.arrayWayToPay.forEach(i=>{this.errorsArrayWayToPay.push({ledgerAccount_id:"",amount:""})}),this.invoiceData.id=e}).catch(async a=>{t.isLoading=!1,console.log(await a)})},async excel(e){const t=r();t.isLoading=!0,await s.post("/invoiceSale-excel",e).then(a=>{t.isLoading=!1,this.pathExcel=a.data.path}).catch(async a=>{t.isLoading=!1,console.log(await a)})},async numberIncrementInvoice(e){const t=r();t.isLoading=!0,await s.get(`/invoiceSale-automaticNumbering/${e}`).then(a=>{t.isLoading=!1,this.formulario.number=a.data.typesReceiptInvoices.prefix+(Number(a.data.typesReceiptInvoices.initialNumbering)+Number(a.data.typesReceiptInvoices.invoices_count)),this.campDisabledAutomaticNumbering=a.data.typesReceiptInvoices.automaticNumbering}).catch(async a=>{t.isLoading=!1,console.log(await a)})},async fetchTypeReceipInvoicetList(e){return this.loading=!0,await s.post("/invoice-select2",e).then(a=>(this.loading=!1,this.typesReceiptInvoices_arrayInfo=a.data.typesReceiptInvoices_arrayInfo)).catch(async a=>{this.loading=!1,console.log(await a)})},async fetchCustomerOfThirdList(e){return this.loading=!0,await s.post("/third-select2",e).then(a=>(this.loading=!1,this.customers_arrayInfo=a.data.customers_arrayInfo)).catch(async a=>{this.loading=!1,console.log(await a)})},async fetchSellerOfUserList(e){return this.loading=!0,await s.post("/user-select2",e).then(a=>(this.loading=!1,this.userSeller_arrayInfo=a.data.userSeller_arrayInfo)).catch(async a=>{this.loading=!1,console.log(await a)})},async fetchLedgerAccountAuxiliaryList(e){return this.loading=!0,await s.post("/invoice-listAuxiliaryAndSubAuxiliary",e).then(a=>(this.loading=!1,this.arrayInfo=a.data.arrayInfo)).catch(async a=>(this.loading=!1,console.log(await a),0))}}});export{l as u};

import{d as w,E as C,b9 as b,k as V,o as s,c as d,p as a,w as o,b as E,q as n,m as e,F,a as S,x as c,I,z as B}from"./index.1bb36a93.js";import{r as N}from"./validators.bb8f1929.js";import{u as T,V as q}from"./useImageUpload.49dcf1d8.js";import{u as z}from"./useCrudProductStore.e1796e7b.js";import{V as f,a as p}from"./VRow.971cb494.js";import{V as L}from"./VTable.ef7fd960.js";import{V as R}from"./VBtn.22d55266.js";import{V as j}from"./VForm.9a7f2cfe.js";const A={key:0,class:"row"},D={class:"col-12"},P=e("thead",null,[e("tr",null,[e("th",null,"Fila"),e("th",null,"Columna"),e("th",null,"Error"),e("th",null,"Valor")])],-1),W=w({__name:"ImportExcel",setup(U){const h=C(),u=z(),{fileExcel:v,errorsImport:_,formulario:y}=b(u),i=V(T());i.value.allowedExtensions=["xls","xlsx"];const m=V(),x=async r=>{var l;await((l=m.value)==null?void 0:l.resetValidation()),u.typeAction=r,r!="back"&&u.keyList++},k=async()=>{var l;v.value=i.value.imageFile;const r=await((l=m.value)==null?void 0:l.validate());if(r!=null&&r.valid){y.value.company_id=h.company.id;const t=await u.importExcel();t.status===200&&x("save"),t.status===422&&(errors.value=t.error)}};return(r,l)=>(s(),d("div",null,[a(j,{ref_key:"formValidation",ref:m,"lazy-validation":""},{default:o(()=>[a(f,null,{default:o(()=>[a(p,{cols:"12"},{default:o(()=>[(s(),E(q,{onChange:n(i).handleImageSelected,rules:[n(N)],key:n(i).key},null,8,["onChange","rules"]))]),_:1})]),_:1}),a(f,null,{default:o(()=>[a(p,{cols:"12"},{default:o(()=>[n(_).length>0?(s(),d("div",A,[e("div",D,[a(L,{"fixed-header":""},{default:o(()=>[P,e("tbody",null,[(s(!0),d(F,null,S(n(_),(t,g)=>(s(),d("tr",{key:g},[e("td",null,c(t.row),1),e("td",null,c(t.attribute),1),e("td",null,c(t.errors),1),e("td",null,c(t.values),1)]))),128))])]),_:1})])])):I("",!0)]),_:1})]),_:1}),a(f,null,{default:o(()=>[a(p,{cols:"12 d-flex justify-content-center"},{default:o(()=>[a(R,{color:"primary",onClick:l[0]||(l[0]=t=>k()),"prepend-icon":"mdi-upload"},{default:o(()=>[B("Subir")]),_:1})]),_:1})]),_:1})]),_:1},512)]))}});export{W as _};

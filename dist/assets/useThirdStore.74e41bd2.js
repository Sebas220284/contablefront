import{bo as l,bg as s,bp as o,bq as c}from"./index.1bb36a93.js";import{S as h}from"./sweetalert2.74fe64d4.js";const r=c(),f=l("useThirdStore",{state:()=>({loading:!0,typeAction:"list",keyList:0,show:!1,showContact:!1,showSeller:!1,showObservation:!1,basicDataType:[],fiscalResponsability:[],typeIdentification:[],typeOfThird:[],typeRegimeIva:[],arrayPhone:[],arrayContact:[],errorsArrayContact:[],errorsArrayPhone:[],userCompany:[],thirds:[],departaments:[],cities:[],thirdData:{},searchThird:{},totalData:0,totalPage:0,currentPage:1,lastPage:0,pathExcel:"",formulario:{name:"",last_name:"",trade_name:"",identifications:"",branch_code:"",departament_id:null,city_id:null,address:"",contact_name:"",contact_last_name:"",email_fac:"",indicative:"",phone_fac:"",postal_code:"",observations:"",basic_data_types_id:null,type_identifications_id:null,type_regime_ivas_id:null,seller_id:null,debt_seller_id:null,company_id:null,arrayFiscalResponsability:[5],arrayTypeThird:[]}}),getters:{},actions:{clearFormulario(){this.formulario={name:"",last_name:"",trade_name:"",identifications:"",branch_code:"",departament_id:null,city_id:null,address:"",contact_name:"",contact_last_name:"",email_fac:"",indicative:"",phone_fac:"",postal_code:"",observations:"",basic_data_types_id:null,type_identifications_id:null,type_regime_ivas_id:null,seller_id:null,debt_seller_id:null,company_id:null,arrayFiscalResponsability:[5],arrayTypeThird:[]},this.fiscalResponsability.forEach(a=>{a.estado="Inactivo",a.id==5&&(a.estado="Activo")}),this.arrayPhone=[],this.arrayContact=[]},clearArrayOfThirds(){this.typeOfThird.forEach(a=>{a.estado="Inactivo",a.id==1&&(this.addTypeThird(a.id),a.estado="Activo")})},async fetchAll(a){this.loading=!0,await s.post("/third-list",a).then(i=>{this.loading=!1,this.thirds=i.data.thirds,this.totalData=i.data.totalData,this.totalPage=i.data.totalPage,this.currentPage=i.data.currentPage,this.lastPage=i.data.lastPage}).catch(async i=>{this.loading=!1,console.log(await i)})},addFormPhone(){this.errorsArrayPhone.push({indicative:"",phone:"",extension:""}),this.arrayPhone.push({id:null,indicative:null,phone:null,extension:null})},deleteFormPhone(a,i){if(i.id){let t=this.arrayPhone.find(e=>e.id===i.id);t.delete="delete"}else this.arrayPhone.splice(a,1)},addFormContact(){this.errorsArrayContact.push({name:"",email:""}),this.arrayContact.push({id:null,name:null,last_name:null,email:null,charge:null,indicative:null,phone:null,delete:null})},deleteFormContact(a,i){if(i.id){let t=this.arrayContact.find(e=>e.id===i.id);t.delete="delete"}else this.arrayContact.splice(a,1)},addFiscalResponsability(a){this.formulario.arrayFiscalResponsability.includes(a)?this.formulario.arrayFiscalResponsability=this.formulario.arrayFiscalResponsability.filter(i=>i!==a):this.formulario.arrayFiscalResponsability.push(a)},addTypeThird(a){this.formulario.arrayTypeThird.includes(a)?this.formulario.arrayTypeThird=this.formulario.arrayTypeThird.filter(i=>i!==a):this.formulario.arrayTypeThird.push(a)},async fetchDataForm(a){const i=o();i.isLoading=!0,await s.post("/third-dataForm",{company_id:a}).then(t=>{i.isLoading=!1,this.basicDataType=t.data.basicDataType,this.fiscalResponsability=t.data.fiscalResponsability,this.typeIdentification=t.data.typeIdentification,this.typeOfThird=t.data.typeOfThird,this.typeRegimeIva=t.data.typeRegimeIva,this.userCompany=t.data.userCompany,this.departaments=t.data.departaments}).catch(async t=>{i.isLoading=!1,console.log(await t)})},async fetchSave(){const a=o();return a.isLoading=!0,await await s.post("/third-create",this.formulario).then(async t=>(a.isLoading=!1,t.data.code===200&&r.toast("\xC9xito",t.data.message,"success"),t.data.code===500&&r.toast("Error",t.data.message,"danger"),t.data.status===422?(r.toast("Error",t.data.message,"danger"),{error:t.data.errors,status:t.data.status}):{status:t.data.code})).catch(async t=>(a.isLoading=!1,console.log("datadata",t.response),{status:t.response.status}))},clonarForm(){for(const a in this.formulario)this.thirdData[a]=this.formulario[a]},async fetchInfoThird(a){const i=o();i.isLoading=!0,await s.get(`/third-info/${a}`).then(async t=>{console.log("RESULT",t.data),i.isLoading=!1,this.formulario=await t.data.data,this.arrayPhone=t.data.data.phones_thirds,this.arrayContact=t.data.data.contacts_thirds,this.formulario.arrayFiscalResponsability=[],t.data.data.fiscal_responsability_thirds.forEach(e=>{this.formulario.arrayFiscalResponsability.push(e.id)}),this.formulario.arrayTypeThird=[],t.data.data.types_thirds.forEach(e=>{this.formulario.arrayTypeThird.push(e.id)}),this.clonarForm(),this.errorsArrayContact=[],this.errorsArrayPhone=[],this.arrayContact.forEach(e=>{this.errorsArrayContact.push({name:"",email:"",last_name:"",charge:"",indicative:"",phone:""})}),this.arrayPhone.forEach(e=>{this.errorsArrayPhone.push({indicative:"",phone:"",extension:""})}),this.thirdData.id=a,console.log()}).catch(async t=>{i.isLoading=!1,console.log(await t)})},changeState(a,i){const t=o();let e="";i==0?e="activar":e="inactivar",h.fire({title:"\xBFEst\xE1 seguro de "+e+" el Registro seleccionado?",showDenyButton:!0,confirmButtonText:"Si",denyButtonText:"No",allowOutsideClick:!1}).then(d=>{d.isConfirmed?(t.isLoading=!0,s.post("/third-state",a).then(n=>{t.isLoading=!1,n.data.code==200&&r.toast("\xC9xito",n.data.msg,"success"),n.data.code==500&&r.toast("\xC9xito",n.data.msg,"error")})):e=="activar"?a.state=0:a.state=1})},async excel(a){const i=o();i.isLoading=!0,await s.post("/third-excel",a).then(t=>{i.isLoading=!1,this.pathExcel=t.data.path}).catch(async t=>{i.isLoading=!1,console.log(await t)})},async getCities(){const a=o();a.isLoading=!0,await s.post("/invoice-cities",{departament_id:this.formulario.departament_id}).then(i=>{this.formulario.city_id=null,a.isLoading=!1,this.cities=i.data.cities}).catch(async i=>{this.formulario.city_id=null,a.isLoading=!1,console.log(await i)})}}});export{f as u};

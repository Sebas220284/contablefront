import{bo as c,bg as n,bp as o,bq as d}from"./index.1bb36a93.js";import{S as u}from"./sweetalert2.74fe64d4.js";const s=d(),y=c("useCrudTypesReceiptInvoiceStore",{state:()=>({showMainData:!0,showAddOnSettings:!0,showElectronicBilling:!0,showChargesAndDiscounts:!0,showChargesAndDiscountsInvoice:!0,typeAction:"list",loading:!1,arrayInfo:[],keyList:0,typesReceiptInvoices:[],arrayChargesAndDiscounts:[],arrayPhone:[],typeReceiptInvoiceData:{},formulario:{id:null,company_id:0,inUse:1,voucherCode:null,voucherName:null,useAsElectronicDocument:0,resolutionNumberDian:null,effectiveDate:null,validityInMonths_id:null,endDateValidity:null,prefix:null,initialNumbering:null,finalNumbering:null,nextInvoiceNumber:null,automaticNumbering:0,deliveryOrder:0,purchaseOrder:0,includeDecimals:0,activateVendorsByItem:0,enableCrossRemittances:0,discountTypePerItem_id:null,LedgerAccountsDiscount_id:null,LedgerAccountsGift_id:null,LedgerAccountsDiscount_table:null,LedgerAccountsGift_table:null,reteIva:0,reteIca:0,selfRetaining:0,invoicingIncomeForThirdParties:0,copaysAdvances:0,format_id:0,titleForDisplay:null,departament_id:null,city_id:null,address:null,observations:null,affair:null,attachFile:null},formChargesAndDiscounts:{id:null,in_use:0,name:null,type_id:null,fee:0,ledgerAccount_id:null,ledgerAccount_table:null},totalData:0,totalPage:0,currentPage:1,links:0,departaments:[],cities:[],validityInMonths:[],discountPerItem:[],formatDisplayPrintInvoice:[],typeChargeAndDiscount:[],dataDetailInvoiceAvailable:[],arrayDataDetailInvoiceAvailable:[],pathExcel:""}),getters:{},actions:{clearFormulario(){this.formulario={id:null,company_id:0,inUse:1,voucherCode:null,voucherName:null,useAsElectronicDocument:0,resolutionNumberDian:null,effectiveDate:null,validityInMonths_id:null,endDateValidity:null,prefix:null,initialNumbering:null,finalNumbering:null,nextInvoiceNumber:null,automaticNumbering:0,deliveryOrder:0,purchaseOrder:0,includeDecimals:0,activateVendorsByItem:0,enableCrossRemittances:0,discountTypePerItem_id:null,LedgerAccountsDiscount_id:null,LedgerAccountsGift_id:null,LedgerAccountsDiscount_table:null,LedgerAccountsGift_table:null,reteIva:0,reteIca:0,selfRetaining:0,invoicingIncomeForThirdParties:0,copaysAdvances:0,format_id:null,titleForDisplay:null,departament_id:null,city_id:null,address:null,observations:null,affair:null,attachFile:null}},clearFormChargesAndDiscounts(){this.formChargesAndDiscounts={id:null,in_use:0,name:null,type_id:null,fee:0,ledgerAccount_id:null,ledgerAccount_table:null}},clearArrays(){this.arrayChargesAndDiscounts=[],this.arrayPhone=[],this.arrayDataDetailInvoiceAvailable=[]},async fetchAll(i){this.loading=!0,await n.post("/invoice-list",i).then(e=>{var t;this.loading=!1,this.typesReceiptInvoices=e.data.typesReceiptInvoices,this.totalData=e.data.totalData,this.totalPage=e.data.totalPage,this.currentPage=e.data.currentPage,this.links=((t=e.data.data)==null?void 0:t.links.length)-2}).catch(async e=>{this.loading=!1,console.log(await e)})},async fetchDataForm(i){const e=o();e.isLoading=!0,await n.post("/invoice-dataForm",{company_id:i}).then(t=>{e.isLoading=!1,this.departaments=t.data.departaments,this.validityInMonths=t.data.validityInMonths,this.discountPerItem=t.data.discountPerItem,this.formatDisplayPrintInvoice=t.data.formatDisplayPrintInvoice,this.typeChargeAndDiscount=t.data.typeChargeAndDiscount,this.dataDetailInvoiceAvailable=t.data.dataDetailInvoiceAvailable}).catch(async t=>{e.isLoading=!1,console.log(await t)})},async fetchSave(){const i=new FormData;for(const a in this.formulario)i.append(a,this.formulario[a]);this.formulario.arrayChargesAndDiscounts=this.arrayChargesAndDiscounts,this.formulario.arrayPhone=this.arrayPhone,this.formulario.arrayDataDetailInvoiceAvailable=this.arrayDataDetailInvoiceAvailable,i.append("arrayChargesAndDiscounts",JSON.stringify(this.formulario.arrayChargesAndDiscounts)),i.append("arrayPhone",JSON.stringify(this.formulario.arrayPhone)),i.append("arrayDataDetailInvoiceAvailable",JSON.stringify(this.formulario.arrayDataDetailInvoiceAvailable));const e=o();return e.isLoading=!0,console.log("this.formulario",i),await await n.post("/invoice-create",i).then(a=>(e.isLoading=!1,a.data.code===200&&s.toast("\xC9xito",a.data.message,"success"),a.data.code===500&&s.toast("Error",a.data.message,"danger"),a.data.status===422?(s.toast("Error",a.data.message,"danger"),{error:a.data.errors,status:a.data.status}):{status:a.data.code,formedit:a.data.data})).catch(async a=>(e.isLoading=!1,console.log("datadata",a.response),a.response.status))},clonarForm(){for(const i in this.formulario)this.typeReceiptInvoiceData[i]=this.formulario[i]},async fetchInfoTypesReceiptInvoices(i){const e=o();if(i!==this.typeReceiptInvoiceData.id)e.isLoading=!0,await n.get(`/invoice-info/${i}`).then(async t=>{e.isLoading=!1,this.formulario=await t.data.data,this.arrayChargesAndDiscounts=t.data.data.charges_and_discounts_invoices,this.arrayPhone=t.data.data.phones_type_receipt_invoice,this.arrayDataDetailInvoiceAvailable=t.data.data.detail_invoice_available;for(let a=0;a<this.dataDetailInvoiceAvailable.length;a++){const r=this.dataDetailInvoiceAvailable[a];this.arrayDataDetailInvoiceAvailable.some(l=>l.id===r.id)&&(this.dataDetailInvoiceAvailable.splice(a,1),a--)}this.clonarForm()}).catch(async t=>{e.isLoading=!1,console.log(await t)});else for(const t in this.typeReceiptInvoiceData)this.formulario[t]=this.typeReceiptInvoiceData[t]},changeState(i,e){const t=o();let a="";e==0?a="activar":a="inactivar",u.fire({title:"\xBFEst\xE1 seguro de "+a+" el Registro seleccionado?",showDenyButton:!0,confirmButtonText:"Si",denyButtonText:"No",allowOutsideClick:!1}).then(r=>{r.isConfirmed?(t.isLoading=!0,n.post("/user-changeState",i).then(l=>{t.isLoading=!1,l.data.code==200&&s.toast("\xC9xito",l.data.msg,"success"),l.data.code==500&&s.toast("\xC9xito",l.data.msg,"danger")})):a=="activar"?i.state=0:i.state=1})},deleteArrayChargesAndDiscounts(i,e){if(e){let t=this.arrayChargesAndDiscounts.find(a=>a.id===e);t&&(t.delete=1)}else this.arrayChargesAndDiscounts.splice(i,1)},addArrayChargesAndDiscounts(){this.arrayChargesAndDiscounts.push({id:null,in_use:0,name:null,type_id:null,fee:0,ledgerAccount_id:null,ledgerAccount_table:null})},addFormPhone(){this.arrayPhone.push({id:null,indicative:null,phone:null,extension:null})},deleteFormPhone(i,e){if(e.id){let t=this.arrayPhone.find(a=>a.id===e.id);t.delete="delete"}else this.arrayPhone.splice(i,1)},async getCities(){const i=o();i.isLoading=!0,await n.post("/invoice-cities",{departament_id:this.formulario.departament_id}).then(e=>{this.formulario.city_id=null,i.isLoading=!1,this.cities=e.data.cities}).catch(async e=>{this.formulario.city_id=null,i.isLoading=!1,console.log(await e)})},async fetchLedgerAccountAuxiliaryList(i){return this.loading=!0,await n.post("/invoice-listAuxiliaryAndSubAuxiliary",i).then(t=>(this.loading=!1,this.arrayInfo=t.data.arrayInfo,t.data.countLinks)).catch(async t=>(this.loading=!1,console.log(await t),0))},async excel(i){const e=o();e.isLoading=!0,await n.post("/invoice-excel",i).then(t=>{e.isLoading=!1,this.pathExcel=t.data.path}).catch(async t=>{e.isLoading=!1,console.log(await t)})},async fetchDelete(i){const e=o();return e.isLoading=!0,await await n.delete(`/invoice-delete/${i}`).then(a=>(e.isLoading=!1,a.data.code===200&&s.toast("\xC9xito",a.data.message,"success"),a.data.code===500&&s.toast("Error",a.data.message,"danger"),a.data.code)).catch(async a=>(e.isLoading=!1,console.log(await a),a.response.state===500&&s.toast("Error",a.response.data.message,"danger"),a.response.state))}}});export{y as u};

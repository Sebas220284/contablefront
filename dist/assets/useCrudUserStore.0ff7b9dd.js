import{E as c,bo as d,bg as i,bp as n,bq as u}from"./index.1bb36a93.js";import{S as h}from"./sweetalert2.74fe64d4.js";const g=c(),e=u(),p=d("useCrudUserStore",{state:()=>({loading:!0,formulario:{email:"",name:"",lastName:"",role_id:null,company_id:null,photo:null,identification:"",phone:""},typeAction:"list",userData:{},keyList:0,users:[],totalData:0,totalPage:0,currentPage:1,lastPage:0,show:!1,arrayRoles:[]}),getters:{},actions:{clearFormulario(){this.formulario={email:"",name:"",lastName:"",role_id:null,company_id:null,photo:null,identification:"",phone:""}},clonarForm(){for(const t in this.formulario)this.userData[t]=this.formulario[t]},async fetchAll(t){this.loading=!0,await i.post("/user-list",t).then(s=>{this.loading=!1,this.users=s.data.user,this.totalData=s.data.totalData,this.totalPage=s.data.totalPage,this.currentPage=s.data.currentPage,this.lastPage=s.data.lastPage}).catch(async s=>{this.loading=!1,console.log(await s)})},async fetchSave(){const t=n(),s=new FormData;for(const a in this.formulario)s.append(a,this.formulario[a]);return t.isLoading=!0,await await i.post("/user-create",s).then(a=>(t.isLoading=!1,a.data.code===200&&(this.formulario=a.data.data,this.clonarForm(),this.clearFormulario(),e.toast("\xC9xito",a.data.message,"success")),a.data.code===500&&e.toast("Error",a.data.message,"danger"),console.log(a.data.status),a.data.status===422?(e.toast("Error",a.data.message,"danger"),{error:a.data.errors,status:a.data.status}):{status:a.data.code})).catch(async a=>(t.isLoading=!1,a.response.status===500&&e.toast("Error",a.response.data.message,"danger"),console.log(await a),{status:a.response.state}))},async fetchDataForm(){const t=n(),s={company_id:g.company.id};t.isLoading=!0,await i.post("/user-dataForm",s).then(o=>{t.isLoading=!1,this.arrayRoles=o.data.roles}).catch(async o=>{t.isLoading=!1,console.log(await o)})},async fetchDelete(t){const s=n();s.isLoading=!0,await i.delete("/user-delete/"+t).then(o=>{s.isLoading=!1,e.toast("\xC9xito",o.data.message,"success")}).catch(async o=>{s.isLoading=!1,console.log(await o)})},async fetchInfoUser(t){const s=n();if(t!==this.userData.id)s.isLoading=!0,await i.get(`/user-info/${t}`).then(async o=>{console.log("RESULT",o),s.isLoading=!1,this.formulario=await o.data.data,console.log("this.formulario",this.formulario),this.clonarForm(),this.userData.id=t}).catch(async o=>{s.isLoading=!1,console.log(await o)});else for(const o in this.userData)this.formulario[o]=this.userData[o]},changeState(t,s){const o=n();let a="";s==0?a="activar":a="inactivar",h.fire({title:"\xBFEst\xE1 seguro de "+a+" el Registro seleccionado?",showDenyButton:!0,confirmButtonText:"Si",denyButtonText:"No",allowOutsideClick:!1}).then(l=>{l.isConfirmed?(o.isLoading=!0,i.post("/user-changeState",t).then(r=>{o.isLoading=!1,r.data.code==200&&e.toast("\xC9xito",r.data.msg,"success"),r.data.code==500&&e.toast("\xC9xito",r.data.msg,"danger")})):a=="activar"?t.state=0:t.state=1})}}});export{p as u};

import{bo as L,bp as d,bg as r,bq as D}from"./index.1bb36a93.js";const n=D(),z=L("useCrudPayrollStore",{state:()=>({loading:!1,typeAction:"list",payrollData:{},keyList:0,payrolls:[],errorsImport:[],totalData:0,totalPage:0,currentPage:1,lastPage:0,employees:[],years:[],generalParametrization:[],transport_assistance:0,health_percentage:0,pension_percentage:0,employeer_pension_percentage:0,employer_compensation_box_percentage:0,layoffs_percentage:0,severance_interest_percentage:0,vacation_percentage:0,fileExcel:null,formulario:{name:null,settlement_type:null,month:null,year:null,company_id:null}}),getters:{},actions:{clearFormulario(){this.formulario={name:null,settlement_type:null,month:null,year:null,company_id:null}},clonarForm(){for(const s in this.formulario)this.payrollData[s]=this.formulario[s]},async fetchDataForm(s){const t=d();t.isLoading=!0,await r.get("/payroll-dataForm/"+s).then(a=>{var f,y,u,P,_,x,w,E;t.isLoading=!1,this.generalParametrization=a.data.generalParametrization;const i=this.generalParametrization.find(o=>o.id==1);this.transport_assistance=(f=i==null?void 0:i.value)!=null?f:0;const l=this.generalParametrization.find(o=>o.id==2);this.health_percentage=(y=l==null?void 0:l.value)!=null?y:0;const e=this.generalParametrization.find(o=>o.id==3);this.pension_percentage=(u=e==null?void 0:e.value)!=null?u:0;const c=this.generalParametrization.find(o=>o.id==4);this.employeer_pension_percentage=(P=c==null?void 0:c.value)!=null?P:0;const g=this.generalParametrization.find(o=>o.id==5);this.employer_compensation_box_percentage=(_=g==null?void 0:g.value)!=null?_:0;const m=this.generalParametrization.find(o=>o.id==6);this.layoffs_percentage=(x=m==null?void 0:m.value)!=null?x:0;const p=this.generalParametrization.find(o=>o.id==7);this.severance_interest_percentage=(w=p==null?void 0:p.value)!=null?w:0;const h=this.generalParametrization.find(o=>o.id==8);this.vacation_percentage=(E=h==null?void 0:h.value)!=null?E:0}).catch(async a=>{t.isLoading=!1,console.log(await a)})},async fetchDataFormRefresh(s){const t=d();t.isLoading=!0,await r.get("/payroll-dataFormRefresh/"+s).then(a=>{t.isLoading=!1,this.years=a.data.years,this.employees=a.data.employees}).catch(async a=>{t.isLoading=!1,console.log(await a)})},async fetchAll(s){this.loading=!0,await r.post("/payroll-list",s).then(t=>{this.loading=!1,this.payrolls=t.data.payrolls,this.totalData=t.data.totalData,this.totalPage=t.data.totalPage,this.currentPage=t.data.currentPage,this.lastPage=t.data.lastPage}).catch(async t=>{this.loading=!1,console.log(await t)})},async fetchSave(s){const t=d();t.isLoading=!0;const a=this.employees.filter(e=>s.includes("check"+e.id));if(a.length<1)return n.toast("Informaci\xF3n","Debe selecionar almenos un empleado","warning"),t.isLoading=!1,{};const i=new FormData;for(const e in this.formulario)i.append(e,this.formulario[e]);return i.append("dataEmployees",JSON.stringify(a)),await await r.post("/payroll-create",i).then(e=>(t.isLoading=!1,e.data.code===200&&(this.clonarForm(),this.clearFormulario(),n.toast("\xC9xito",e.data.message,"success")),e.data.code===500&&n.toast("Error",e.data.message,"danger"),e.data.status===422?(n.toast("Error",e.data.message,"danger"),{error:e.data.errors,status:e.data.status}):{status:e.data.code,formedit:e.data.data})).catch(async e=>(t.isLoading=!1,e.response.status===500&&n.toast("Error",e.response.data.message,"danger"),console.log(await e),e.response.status))},async importExcel(){if(this.fileExcel!==null){const s=d(),t=new FormData;for(const a in this.formulario)t.append(a,this.formulario[a]);return t.append("fileExcel",this.fileExcel),await r.post("/payroll-importExcel",t).then(a=>(s.isLoading=!1,a.data.code===200&&n.toast("\xC9xito",a.data.message,"success"),a.data.code===500&&n.toast("Error",a.data.message,"danger"),a.data.code===422?(n.toast("Error",a.data.message,"danger"),this.errorsImport=a.data.errorsImport,{status:a.data.code}):{status:a.data.code,formedit:a.data.data})).catch(async a=>(s.isLoading=!1,console.log("datadata",a.response),a.response.status))}return{}}}});export{z as u};
